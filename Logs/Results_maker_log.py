import re
import os
import pandas as pd

data ="""734.2s 3155 Epoch 5/1000 Loss: 9.5096 Acc: 0.6064 F1: 0.1987
767.3s 3156 Epoch 10/1000 Loss: 4.1099 Acc: 0.6279 F1: 0.2643
797.2s 3157 Epoch 15/1000 Loss: 1.6511 Acc: 0.6173 F1: 0.2634
826.0s 3158 Epoch 20/1000 Loss: 1.1780 Acc: 0.6490 F1: 0.2872
855.7s 3159 Epoch 25/1000 Loss: 0.9610 Acc: 0.6919 F1: 0.2947
886.1s 3160 Epoch 30/1000 Loss: 0.7492 Acc: 0.7777 F1: 0.3059
917.1s 3161 Epoch 35/1000 Loss: 0.6576 Acc: 0.7949 F1: 0.3141
947.8s 3162 Epoch 40/1000 Loss: 0.5615 Acc: 0.8122 F1: 0.3319
979.0s 3163 Epoch 45/1000 Loss: 0.4857 Acc: 0.8329 F1: 0.3875
1009.7s 3164 Epoch 50/1000 Loss: 0.4302 Acc: 0.8572 F1: 0.4308
1040.4s 3165 Epoch 55/1000 Loss: 0.3880 Acc: 0.8762 F1: 0.4497
1071.3s 3166 Epoch 60/1000 Loss: 0.3484 Acc: 0.8881 F1: 0.4672
1102.1s 3167 Epoch 65/1000 Loss: 0.3238 Acc: 0.8987 F1: 0.4767
1132.9s 3168 Epoch 70/1000 Loss: 0.2979 Acc: 0.9019 F1: 0.4805
1163.7s 3169 Epoch 75/1000 Loss: 0.2758 Acc: 0.9085 F1: 0.4864
1194.9s 3170 Epoch 80/1000 Loss: 0.2600 Acc: 0.9128 F1: 0.4926
1226.3s 3171 Epoch 85/1000 Loss: 0.2448 Acc: 0.9163 F1: 0.4948
1257.4s 3172 Epoch 90/1000 Loss: 0.2332 Acc: 0.9191 F1: 0.4970
1288.7s 3173 Epoch 95/1000 Loss: 0.2163 Acc: 0.9360 F1: 0.5497
1319.9s 3174 Epoch 100/1000 Loss: 0.2124 Acc: 0.9395 F1: 0.5521
1351.2s 3175 Epoch 105/1000 Loss: 0.2071 Acc: 0.9399 F1: 0.5534
1382.4s 3176 Epoch 110/1000 Loss: 0.2008 Acc: 0.9427 F1: 0.5662
1413.3s 3177 Epoch 115/1000 Loss: 0.1927 Acc: 0.9434 F1: 0.5851
1444.1s 3178 Epoch 120/1000 Loss: 0.1847 Acc: 0.9441 F1: 0.5893
1475.4s 3179 Epoch 125/1000 Loss: 0.1799 Acc: 0.9462 F1: 0.5933
1506.6s 3180 Epoch 130/1000 Loss: 0.1748 Acc: 0.9476 F1: 0.5948
1537.9s 3181 Epoch 135/1000 Loss: 0.1702 Acc: 0.9462 F1: 0.5943
1569.5s 3182 Epoch 140/1000 Loss: 0.1659 Acc: 0.9501 F1: 0.6021
1600.8s 3183 Epoch 145/1000 Loss: 0.1619 Acc: 0.9518 F1: 0.6028
1632.5s 3184 Epoch 150/1000 Loss: 0.1585 Acc: 0.9525 F1: 0.6026
1663.8s 3185 Epoch 155/1000 Loss: 0.1523 Acc: 0.9529 F1: 0.6265
1695.1s 3186 Epoch 160/1000 Loss: 0.1502 Acc: 0.9560 F1: 0.6461
1726.7s 3187 Epoch 165/1000 Loss: 0.1418 Acc: 0.9581 F1: 0.6486
1758.0s 3188 Epoch 170/1000 Loss: 0.1383 Acc: 0.9617 F1: 0.6615
1789.4s 3189 Epoch 175/1000 Loss: 0.1343 Acc: 0.9613 F1: 0.6532
1821.3s 3190 Epoch 180/1000 Loss: 0.1304 Acc: 0.9627 F1: 0.6606
1853.1s 3191 Epoch 185/1000 Loss: 0.1284 Acc: 0.9652 F1: 0.6686
1884.9s 3192 Epoch 190/1000 Loss: 0.1243 Acc: 0.9631 F1: 0.6518
1916.4s 3193 Epoch 195/1000 Loss: 0.1205 Acc: 0.9666 F1: 0.6817
1948.7s 3194 Epoch 200/1000 Loss: 0.1153 Acc: 0.9666 F1: 0.6780
1980.6s 3195 Epoch 205/1000 Loss: 0.1127 Acc: 0.9680 F1: 0.6834
2012.5s 3196 Epoch 210/1000 Loss: 0.1078 Acc: 0.9680 F1: 0.6807
2044.3s 3197 Epoch 215/1000 Loss: 0.1062 Acc: 0.9701 F1: 0.6811
2076.3s 3198 Epoch 220/1000 Loss: 0.1013 Acc: 0.9705 F1: 0.6769
2108.2s 3199 Epoch 225/1000 Loss: 0.0958 Acc: 0.9712 F1: 0.6906
2140.2s 3200 Epoch 230/1000 Loss: 0.0925 Acc: 0.9729 F1: 0.6925
2173.3s 3201 Epoch 235/1000 Loss: 0.0906 Acc: 0.9719 F1: 0.6846
2205.8s 3202 Epoch 240/1000 Loss: 0.0855 Acc: 0.9729 F1: 0.6840
2238.0s 3203 Epoch 245/1000 Loss: 0.0817 Acc: 0.9733 F1: 0.6864
2270.1s 3204 Epoch 250/1000 Loss: 0.0806 Acc: 0.9747 F1: 0.6952
2302.2s 3205 Epoch 255/1000 Loss: 0.0797 Acc: 0.9750 F1: 0.7435
2334.5s 3206 Epoch 260/1000 Loss: 0.0736 Acc: 0.9775 F1: 0.7571
2366.5s 3207 Epoch 265/1000 Loss: 0.0693 Acc: 0.9761 F1: 0.7553
2398.7s 3208 Epoch 270/1000 Loss: 0.0654 Acc: 0.9792 F1: 0.7742
2430.7s 3209 Epoch 275/1000 Loss: 0.0637 Acc: 0.9800 F1: 0.7792
2463.0s 3210 Epoch 280/1000 Loss: 0.0623 Acc: 0.9803 F1: 0.7874
2494.9s 3211 Epoch 285/1000 Loss: 0.0583 Acc: 0.9807 F1: 0.7775
2527.1s 3212 Epoch 290/1000 Loss: 0.0561 Acc: 0.9807 F1: 0.7817
2559.4s 3213 Epoch 295/1000 Loss: 0.0544 Acc: 0.9807 F1: 0.7836
2591.7s 3214 Epoch 300/1000 Loss: 0.0526 Acc: 0.9814 F1: 0.7853
2623.9s 3215 Epoch 305/1000 Loss: 0.0519 Acc: 0.9814 F1: 0.7892
2656.4s 3216 Epoch 310/1000 Loss: 0.0474 Acc: 0.9842 F1: 0.8185
2688.5s 3217 Epoch 315/1000 Loss: 0.0442 Acc: 0.9838 F1: 0.8365
2720.8s 3218 Epoch 320/1000 Loss: 0.0416 Acc: 0.9845 F1: 0.8349
2753.4s 3219 Epoch 325/1000 Loss: 0.0406 Acc: 0.9856 F1: 0.8546
2785.7s 3220 Epoch 330/1000 Loss: 0.0394 Acc: 0.9849 F1: 0.8671
2818.3s 3221 Epoch 335/1000 Loss: 0.0383 Acc: 0.9849 F1: 0.8591
2850.8s 3222 Epoch 340/1000 Loss: 0.0377 Acc: 0.9866 F1: 0.8645
2883.2s 3223 Epoch 345/1000 Loss: 0.0360 Acc: 0.9866 F1: 0.8644
2915.8s 3224 Epoch 350/1000 Loss: 0.0347 Acc: 0.9877 F1: 0.8675
2948.3s 3225 Epoch 355/1000 Loss: 0.0344 Acc: 0.9880 F1: 0.8956
2980.7s 3226 Epoch 360/1000 Loss: 0.0347 Acc: 0.9873 F1: 0.8676
3013.4s 3227 Epoch 365/1000 Loss: 0.0333 Acc: 0.9880 F1: 0.8688
3045.8s 3228 Epoch 370/1000 Loss: 0.0308 Acc: 0.9880 F1: 0.8955
3077.9s 3229 Epoch 375/1000 Loss: 0.0312 Acc: 0.9884 F1: 0.9030
3110.1s 3230 Epoch 380/1000 Loss: 0.0332 Acc: 0.9831 F1: 0.8727
3142.2s 3231 Epoch 385/1000 Loss: 0.0356 Acc: 0.9894 F1: 0.9158
3174.6s 3232 Epoch 390/1000 Loss: 0.0293 Acc: 0.9898 F1: 0.9093
3206.9s 3233 Epoch 395/1000 Loss: 0.0289 Acc: 0.9905 F1: 0.9141
3239.4s 3234 Epoch 400/1000 Loss: 0.0274 Acc: 0.9905 F1: 0.9198
3271.7s 3235 Epoch 405/1000 Loss: 0.0270 Acc: 0.9909 F1: 0.8900
3304.1s 3236 Epoch 410/1000 Loss: 0.0243 Acc: 0.9919 F1: 0.9270
3336.7s 3237 Epoch 415/1000 Loss: 0.0232 Acc: 0.9916 F1: 0.9244
3369.0s 3238 Epoch 420/1000 Loss: 0.0244 Acc: 0.9916 F1: 0.9209
3401.4s 3239 Epoch 425/1000 Loss: 0.0225 Acc: 0.9912 F1: 0.9252
3434.0s 3240 Epoch 430/1000 Loss: 0.0238 Acc: 0.9923 F1: 0.9276
3466.6s 3241 Epoch 435/1000 Loss: 0.0206 Acc: 0.9916 F1: 0.9263
3499.0s 3242 Epoch 440/1000 Loss: 0.0201 Acc: 0.9919 F1: 0.9227
3531.9s 3243 Epoch 445/1000 Loss: 0.0193 Acc: 0.9930 F1: 0.9453
3564.1s 3244 Epoch 450/1000 Loss: 0.0199 Acc: 0.9926 F1: 0.9490
3596.6s 3245 Epoch 455/1000 Loss: 0.0183 Acc: 0.9933 F1: 0.9505
3629.1s 3246 Epoch 460/1000 Loss: 0.0175 Acc: 0.9944 F1: 0.9530
3661.6s 3247 Epoch 465/1000 Loss: 0.0186 Acc: 0.9940 F1: 0.9514
3694.2s 3248 Epoch 470/1000 Loss: 0.0167 Acc: 0.9940 F1: 0.9533
3727.0s 3249 Epoch 475/1000 Loss: 0.0173 Acc: 0.9940 F1: 0.9478
3759.7s 3250 Epoch 480/1000 Loss: 0.0165 Acc: 0.9947 F1: 0.9651
3793.0s 3251 Epoch 485/1000 Loss: 0.0158 Acc: 0.9947 F1: 0.9643
3825.9s 3252 Epoch 490/1000 Loss: 0.0176 Acc: 0.9944 F1: 0.9627
3858.7s 3253 Epoch 495/1000 Loss: 0.0152 Acc: 0.9951 F1: 0.9644
3891.7s 3254 Epoch 500/1000 Loss: 0.0168 Acc: 0.9947 F1: 0.9652
3924.6s 3255 Epoch 505/1000 Loss: 0.0157 Acc: 0.9951 F1: 0.9656
3957.1s 3256 Epoch 510/1000 Loss: 0.0164 Acc: 0.9951 F1: 0.9660
3989.8s 3257 Epoch 515/1000 Loss: 0.0160 Acc: 0.9951 F1: 0.9644
4022.5s 3258 Epoch 520/1000 Loss: 0.0136 Acc: 0.9954 F1: 0.9671
4055.2s 3259 Epoch 525/1000 Loss: 0.0134 Acc: 0.9958 F1: 0.9698
4087.8s 3260 Epoch 530/1000 Loss: 0.0137 Acc: 0.9954 F1: 0.9669
4121.1s 3261 Epoch 535/1000 Loss: 0.0132 Acc: 0.9951 F1: 0.9657
4153.8s 3262 Epoch 540/1000 Loss: 0.0139 Acc: 0.9947 F1: 0.9648
4186.9s 3263 Epoch 545/1000 Loss: 0.0134 Acc: 0.9951 F1: 0.9677
4219.9s 3264 Epoch 550/1000 Loss: 0.0121 Acc: 0.9958 F1: 0.9674
4252.7s 3265 Epoch 555/1000 Loss: 0.0120 Acc: 0.9954 F1: 0.9666
4285.2s 3266 Epoch 560/1000 Loss: 0.0119 Acc: 0.9954 F1: 0.9659
4317.9s 3267 Epoch 565/1000 Loss: 0.0132 Acc: 0.9958 F1: 0.9688
4350.8s 3268 Epoch 570/1000 Loss: 0.0123 Acc: 0.9954 F1: 0.9680
4383.6s 3269 Epoch 575/1000 Loss: 0.0120 Acc: 0.9958 F1: 0.9699
4416.5s 3270 Epoch 580/1000 Loss: 0.0124 Acc: 0.9954 F1: 0.9667
4449.3s 3271 Epoch 585/1000 Loss: 0.0124 Acc: 0.9958 F1: 0.9673
4481.9s 3272 Epoch 590/1000 Loss: 0.0116 Acc: 0.9958 F1: 0.9688
4515.1s 3273 Epoch 595/1000 Loss: 0.0123 Acc: 0.9954 F1: 0.9632
4547.9s 3274 Epoch 600/1000 Loss: 0.0114 Acc: 0.9961 F1: 0.9710
4581.1s 3275 Epoch 605/1000 Loss: 0.0113 Acc: 0.9958 F1: 0.9688
4613.9s 3276 Epoch 610/1000 Loss: 0.0115 Acc: 0.9954 F1: 0.9661
4646.8s 3277 Epoch 615/1000 Loss: 0.0127 Acc: 0.9954 F1: 0.9659
4679.9s 3278 Epoch 620/1000 Loss: 0.0119 Acc: 0.9961 F1: 0.9710
4712.8s 3279 Epoch 625/1000 Loss: 0.0115 Acc: 0.9961 F1: 0.9710
4745.4s 3280 Epoch 630/1000 Loss: 0.0118 Acc: 0.9954 F1: 0.9659
4778.4s 3281 Epoch 635/1000 Loss: 0.0112 Acc: 0.9961 F1: 0.9710
4811.6s 3282 Epoch 640/1000 Loss: 0.0106 Acc: 0.9961 F1: 0.9717
4844.8s 3283 Epoch 645/1000 Loss: 0.0111 Acc: 0.9965 F1: 0.9734
4878.0s 3284 Epoch 650/1000 Loss: 0.0114 Acc: 0.9954 F1: 0.9666
4911.0s 3285 Epoch 655/1000 Loss: 0.0113 Acc: 0.9954 F1: 0.9659
4944.1s 3286 Epoch 660/1000 Loss: 0.0115 Acc: 0.9961 F1: 0.9710
4977.2s 3287 Epoch 665/1000 Loss: 0.0110 Acc: 0.9961 F1: 0.9710
5010.2s 3288 Epoch 670/1000 Loss: 0.0105 Acc: 0.9958 F1: 0.9673
5043.5s 3289 Epoch 675/1000 Loss: 0.0110 Acc: 0.9961 F1: 0.9710
5076.8s 3290 Epoch 680/1000 Loss: 0.0121 Acc: 0.9961 F1: 0.9710
5110.0s 3291 Epoch 685/1000 Loss: 0.0112 Acc: 0.9954 F1: 0.9656
5143.3s 3292 Epoch 690/1000 Loss: 0.0110 Acc: 0.9954 F1: 0.9659
5176.4s 3293 Epoch 695/1000 Loss: 0.0105 Acc: 0.9954 F1: 0.9661
5209.6s 3294 Epoch 700/1000 Loss: 0.0109 Acc: 0.9961 F1: 0.9710
5242.7s 3295 Epoch 705/1000 Loss: 0.0113 Acc: 0.9961 F1: 0.9707
5275.8s 3296 Epoch 710/1000 Loss: 0.0106 Acc: 0.9961 F1: 0.9707
5308.7s 3297 Epoch 715/1000 Loss: 0.0105 Acc: 0.9961 F1: 0.9699
5341.6s 3298 Epoch 720/1000 Loss: 0.0102 Acc: 0.9961 F1: 0.9710
5374.6s 3299 Epoch 725/1000 Loss: 0.0113 Acc: 0.9965 F1: 0.9724
5407.8s 3300 Epoch 730/1000 Loss: 0.0102 Acc: 0.9958 F1: 0.9692
5441.0s 3301 Epoch 735/1000 Loss: 0.0107 Acc: 0.9961 F1: 0.9710
5474.2s 3302 Epoch 740/1000 Loss: 0.0112 Acc: 0.9961 F1: 0.9710
5507.4s 3303 Epoch 745/1000 Loss: 0.0107 Acc: 0.9961 F1: 0.9709
5540.7s 3304 Epoch 750/1000 Loss: 0.0104 Acc: 0.9965 F1: 0.9734
5574.1s 3305 Epoch 755/1000 Loss: 0.0093 Acc: 0.9968 F1: 0.9764
5607.8s 3306 Epoch 760/1000 Loss: 0.0101 Acc: 0.9965 F1: 0.9734
5641.5s 3307 Epoch 765/1000 Loss: 0.0117 Acc: 0.9961 F1: 0.9674
5674.9s 3308 Epoch 770/1000 Loss: 0.0101 Acc: 0.9958 F1: 0.9645
5707.9s 3309 Epoch 775/1000 Loss: 0.0098 Acc: 0.9968 F1: 0.9751
5741.0s 3310 Epoch 780/1000 Loss: 0.0097 Acc: 0.9965 F1: 0.9734
5774.2s 3311 Epoch 785/1000 Loss: 0.0106 Acc: 0.9965 F1: 0.9716
5806.7s 3312 Epoch 790/1000 Loss: 0.0102 Acc: 0.9968 F1: 0.9741
5839.1s 3313 Epoch 795/1000 Loss: 0.0095 Acc: 0.9965 F1: 0.9716
5871.4s 3314 Epoch 800/1000 Loss: 0.0101 Acc: 0.9965 F1: 0.9712
5903.7s 3315 Epoch 805/1000 Loss: 0.0118 Acc: 0.9937 F1: 0.9585
5936.0s 3316 Epoch 810/1000 Loss: 0.0114 Acc: 0.9968 F1: 0.9752
5968.1s 3317 Epoch 815/1000 Loss: 0.0114 Acc: 0.9968 F1: 0.9725
6000.2s 3318 Epoch 820/1000 Loss: 0.0110 Acc: 0.9961 F1: 0.9685
6032.7s 3319 Epoch 825/1000 Loss: 0.0124 Acc: 0.9968 F1: 0.9735
6064.8s 3320 Epoch 830/1000 Loss: 0.0228 Acc: 0.9937 F1: 0.9630
6096.8s 3321 Epoch 835/1000 Loss: 0.0141 Acc: 0.9951 F1: 0.9545
6128.7s 3322 Epoch 840/1000 Loss: 0.0123 Acc: 0.9947 F1: 0.9673
6160.5s 3323 Epoch 845/1000 Loss: 0.0140 Acc: 0.9968 F1: 0.9749
6192.2s 3324 Epoch 850/1000 Loss: 0.0129 Acc: 0.9958 F1: 0.9695
6223.6s 3325 Epoch 855/1000 Loss: 0.0138 Acc: 0.9961 F1: 0.9729
6255.5s 3326 Epoch 860/1000 Loss: 0.0146 Acc: 0.9972 F1: 0.9777
6287.5s 3327 Epoch 865/1000 Loss: 0.0148 Acc: 0.9965 F1: 0.9730
6319.4s 3328 Epoch 870/1000 Loss: 0.0124 Acc: 0.9951 F1: 0.9654
6351.6s 3329 Epoch 875/1000 Loss: 0.0122 Acc: 0.9972 F1: 0.9763
6384.7s 3330 Epoch 880/1000 Loss: 0.0105 Acc: 0.9975 F1: 0.9780
6417.8s 3331 Epoch 885/1000 Loss: 0.0105 Acc: 0.9975 F1: 0.9795
6450.2s 3332 Epoch 890/1000 Loss: 0.0120 Acc: 0.9979 F1: 0.9802
6483.4s 3333 Epoch 895/1000 Loss: 0.0100 Acc: 0.9975 F1: 0.9798
6516.5s 3334 Epoch 900/1000 Loss: 0.0085 Acc: 0.9982 F1: 0.9817
6549.9s 3335 Epoch 905/1000 Loss: 0.0084 Acc: 0.9982 F1: 0.9824
6583.0s 3336 Epoch 910/1000 Loss: 0.0076 Acc: 0.9979 F1: 0.9802
6616.3s 3337 Epoch 915/1000 Loss: 0.0085 Acc: 0.9982 F1: 0.9817
6649.7s 3338 Epoch 920/1000 Loss: 0.0072 Acc: 0.9986 F1: 0.9910
6683.1s 3339 Epoch 925/1000 Loss: 0.0081 Acc: 0.9986 F1: 0.9910
6716.3s 3340 Epoch 930/1000 Loss: 0.0063 Acc: 0.9986 F1: 0.9910
6749.8s 3341 Epoch 935/1000 Loss: 0.0062 Acc: 0.9986 F1: 0.9910
6783.0s 3342 Epoch 940/1000 Loss: 0.0063 Acc: 0.9986 F1: 0.9910
6815.9s 3343 Epoch 945/1000 Loss: 0.0048 Acc: 0.9986 F1: 0.9910
6849.1s 3344 Epoch 950/1000 Loss: 0.0050 Acc: 0.9982 F1: 0.9895
6882.8s 3345 Epoch 955/1000 Loss: 0.0047 Acc: 0.9982 F1: 0.9895
6916.3s 3346 Epoch 960/1000 Loss: 0.0054 Acc: 0.9986 F1: 0.9910
6949.2s 3347 Epoch 965/1000 Loss: 0.0050 Acc: 0.9986 F1: 0.9910
6982.8s 3348 Epoch 970/1000 Loss: 0.0050 Acc: 0.9986 F1: 0.9910
7016.2s 3349 Epoch 975/1000 Loss: 0.0049 Acc: 0.9986 F1: 0.9910
7049.4s 3350 Epoch 980/1000 Loss: 0.0042 Acc: 0.9986 F1: 0.9910
7082.7s 3351 Epoch 985/1000 Loss: 0.0046 Acc: 0.9986 F1: 0.9910
7116.0s 3352 Epoch 990/1000 Loss: 0.0050 Acc: 0.9986 F1: 0.9910
7149.3s 3353 Epoch 995/1000 Loss: 0.0044 Acc: 0.9989 F1: 0.9940
7182.5s 3354 Epoch 1000/1000 Loss: 0.0043 Acc: 0.9989 F1: 0.9939"""


pattern = re.compile(r"Epoch (\d+)/\d+ Loss: ([\d\.]+) Acc: ([\d\.]+) F1: ([\d\.]+)")

results_ = {
    "Epoch": [],
    "Loss":[],
    "Acc":[],
    "F1": []
}
for match in pattern.finditer(data):
    epoch, loss, acc, f1 = match.groups()
    results_["Epoch"].append(int(epoch))
    results_["Loss"].append(float(loss))
    results_["Acc"].append(float(acc))
    results_["F1"].append(float(f1))
    

df = pd.DataFrame(results_)
df.to_csv("../Results/Law_w_Results.csv", index=False)
# df.to_csv("../Results/Law_agg_Results.csv", index=False)